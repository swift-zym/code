#include<bits/stdc++.h>
#define KUAN 5
#define KUAN2 7
#define min(a,b) (a>b?b:a)
#define max(a,b) (a>b?a:b)
using namespace std;
int h,w,t;
string a[66];
string number[16][65]={{
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "...............########...............",
                               ".............############.............",
                               "...........################...........",
                               "..........##################..........",
                               ".........####################.........",
                               "........######################........",
                               ".......########################.......",
                               ".......##########....##########.......",
                               "......#########........#########......",
                               "......########..........########......",
                               ".....#########..........#########.....",
                               ".....########............########.....",
                               ".....########............########.....",
                               ".....########............########.....",
                               "....########..............########....",
                               "....########..............########....",
                               "....########..............########....",
                               "....########..............########....",
                               "....########..............########....",
                               "....########..............########....",
                               "....########..............########....",
                               "....########..............########....",
                               "....########..............########....",
                               "....########..............########....",
                               "....########..............########....",
                               ".....########............########.....",
                               ".....########............########.....",
                               ".....########............########.....",
                               ".....#########..........#########.....",
                               "......########..........########......",
                               "......#########........#########......",
                               ".......##########....##########.......",
                               ".......########################.......",
                               "........######################........",
                               ".........####################.........",
                               "..........##################..........",
                               "...........################...........",
                               ".............############.............",
                               "...............########...............",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................"
                       },
                       {
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "...................####...............",
                               ".................#######..............",
                               "..............##########..............",
                               "...........#############..............",
                               "........################..............",
                               ".......#################..............",
                               ".......#################..............",
                               ".......#################..............",
                               ".......#################..............",
                               "........######..########..............",
                               "........###.....########..............",
                               "................########..............",
                               "................########..............",
                               "................########..............",
                               "................########..............",
                               "................########..............",
                               "................########..............",
                               "................########..............",
                               "................########..............",
                               "................########..............",
                               "................########..............",
                               "................########..............",
                               "................########..............",
                               "................########..............",
                               "................########..............",
                               "................########..............",
                               "................########..............",
                               "................########..............",
                               "................########..............",
                               "................########..............",
                               "................########..............",
                               "................########..............",
                               ".......##########################.....",
                               "......###########################.....",
                               "......###########################.....",
                               "......###########################.....",
                               "......###########################.....",
                               ".......##########################.....",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................"
                       },
                       {
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "..............#########...............",
                               "...........##############.............",
                               "........###################...........",
                               ".......#####################..........",
                               "......#######################.........",
                               "......#######################.........",
                               "......########################........",
                               "......#########......#########........",
                               "......#######.........#########.......",
                               "......#######..........########.......",
                               "......#######..........########.......",
                               "......#######..........########.......",
                               "......#######..........########.......",
                               ".......######..........########.......",
                               "......................#########.......",
                               "......................########........",
                               ".....................#########........",
                               "....................##########........",
                               "...................##########.........",
                               "..................###########.........",
                               ".................###########..........",
                               "................###########...........",
                               "...............###########............",
                               "..............###########.............",
                               ".............###########..............",
                               "............###########...............",
                               "...........###########.....#####......",
                               "..........###########.....#######.....",
                               ".........###########......#######.....",
                               "........###########.......#######.....",
                               ".......###########........#######.....",
                               "......###########.........#######.....",
                               ".....############################.....",
                               ".....############################.....",
                               ".....############################.....",
                               ".....############################.....",
                               ".....############################.....",
                               "......###########################.....",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                       },
                       {
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "..............##########..............",
                               "..........################............",
                               "........####################..........",
                               ".......######################.........",
                               ".......#######################........",
                               ".......########################.......",
                               ".......########################.......",
                               ".......########.......##########......",
                               ".......#######.........#########......",
                               ".......#######..........########......",
                               ".......#######..........########......",
                               "........######..........########......",
                               "........................########......",
                               "........................########......",
                               ".......................########.......",
                               "......................#########.......",
                               "...............###############........",
                               "..............###############.........",
                               "..............##############..........",
                               "..............###############.........",
                               "..............################........",
                               "...............################.......",
                               "......................##########......",
                               "........................########......",
                               "........................#########.....",
                               ".........................########.....",
                               ".........................########.....",
                               ".........................########.....",
                               ".........................########.....",
                               "........................#########.....",
                               ".......###.............##########.....",
                               "......########........##########......",
                               "......##########################......",
                               "......#########################.......",
                               ".....##########################.......",
                               "......########################........",
                               "......######################..........",
                               ".........#################............",
                               "............###########...............",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................"
                       },
                       {
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               ".....................#####............",
                               "....................#######...........",
                               "...................########...........",
                               "..................#########...........",
                               ".................##########...........",
                               "................###########...........",
                               "................###########...........",
                               "...............############...........",
                               "..............#############...........",
                               ".............##############...........",
                               "............###############...........",
                               "...........################...........",
                               "...........########.#######...........",
                               "..........########..#######...........",
                               ".........########...#######...........",
                               "........########....#######...........",
                               ".......#########....#######...........",
                               ".......########.....#######...........",
                               "......########......#######...........",
                               ".....########.......#######...........",
                               "....##############################....",
                               "....##############################....",
                               "....##############################....",
                               "....##############################....",
                               "....##############################....",
                               "....##############################....",
                               "...................########...........",
                               "...................########...........",
                               "...................########...........",
                               "...................########...........",
                               "...................########...........",
                               "...................########...........",
                               ".............####################.....",
                               "............#####################.....",
                               "............#####################.....",
                               "............#####################.....",
                               "............#####################.....",
                               ".............####################.....",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................"
                       },
                       {
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "........######################........",
                               "........#######################.......",
                               "........#######################.......",
                               "........#######################.......",
                               "........#######################.......",
                               "........######################........",
                               "........#######.......................",
                               "........#######.......................",
                               "........#######.......................",
                               "........#######.......................",
                               "........#######.......................",
                               "........#######.......................",
                               ".......########..########.............",
                               ".......####################...........",
                               ".......######################.........",
                               ".......#######################........",
                               ".......########################.......",
                               ".......########################.......",
                               ".......#########################......",
                               ".......########.......##########......",
                               "..........##...........#########......",
                               "........................#########.....",
                               ".........................########.....",
                               ".........................########.....",
                               ".........................########.....",
                               ".........................########.....",
                               ".........................########.....",
                               ".........................########.....",
                               "........#...............#########.....",
                               ".......####............#########......",
                               "......########.......###########......",
                               "......##########################......",
                               "......#########################.......",
                               ".....#########################........",
                               "......#######################.........",
                               ".......#####################..........",
                               ".........#################............",
                               ".............##########...............",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................"
                       },
                       {
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               ".........................######.......",
                               "....................###########.......",
                               ".................###############......",
                               "...............#################......",
                               ".............###################......",
                               "............####################......",
                               "...........####################.......",
                               "..........################............",
                               ".........############.................",
                               "........###########...................",
                               "........#########.....................",
                               ".......#########......................",
                               ".......########.......................",
                               "......########........................",
                               "......########........................",
                               "......#######....########.............",
                               "......#######..#############..........",
                               ".....#########################........",
                               ".....##########################.......",
                               ".....###########################......",
                               ".....###########################......",
                               ".....############......##########.....",
                               ".....##########.........#########.....",
                               ".....#########...........#########....",
                               ".....########.............########....",
                               ".....########.............########....",
                               ".....########.............########....",
                               "......#######.............########....",
                               "......#######.............########....",
                               "......########...........#########....",
                               "......#########.........#########.....",
                               ".......##########.....###########.....",
                               "........#########################.....",
                               "........########################......",
                               ".........######################.......",
                               "..........####################........",
                               "...........##################.........",
                               ".............##############...........",
                               "................########..............",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................"
                       },
                       {
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......###########################.....",
                               "......############################....",
                               "......############################....",
                               "......############################....",
                               "......############################....",
                               "......###########################.....",
                               "......#######...........#########.....",
                               "......#######...........#########.....",
                               "......#######..........#########......",
                               "......#######..........#########......",
                               "......#######..........########.......",
                               "......#######.........#########.......",
                               "......#######.........########........",
                               "......#######........#########........",
                               ".......#####.........#########........",
                               ".....................########.........",
                               "....................#########.........",
                               "....................########..........",
                               "...................#########..........",
                               "...................########...........",
                               "..................#########...........",
                               "..................#########...........",
                               "..................########............",
                               ".................#########............",
                               ".................########.............",
                               "................#########.............",
                               "................########..............",
                               "................########..............",
                               "...............########...............",
                               "...............########...............",
                               "..............#########...............",
                               "..............########................",
                               "..............########................",
                               ".............########.................",
                               ".............########.................",
                               ".............#######..................",
                               ".............#######..................",
                               "...............#####..................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................"
                       },
                       {
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "...............#########..............",
                               ".............#############............",
                               "...........#################..........",
                               "..........###################.........",
                               ".........#####################........",
                               "........#######################.......",
                               "........#######################.......",
                               "........#########.....#########.......",
                               ".......#########.......#########......",
                               ".......########.........########......",
                               ".......########.........########......",
                               ".......########.........########......",
                               ".......########.........########......",
                               ".......########.........########......",
                               "........########.......########.......",
                               "........#########.....#########.......",
                               ".........#####################........",
                               "..........###################.........",
                               "...........#################..........",
                               "...........#################..........",
                               ".........#####################........",
                               "........#######################.......",
                               ".......#########......##########......",
                               "......########..........########......",
                               "......########..........#########.....",
                               ".....########............########.....",
                               ".....########............########.....",
                               ".....########............########.....",
                               ".....########............########.....",
                               ".....#########..........#########.....",
                               ".....#########..........#########.....",
                               "......##########......##########......",
                               "......##########################......",
                               ".......########################.......",
                               ".......########################.......",
                               "........######################........",
                               ".........####################.........",
                               "...........################...........",
                               "..............##########..............",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................"
                       },
                       {
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "..............#########...............",
                               "............#############.............",
                               "..........#################...........",
                               ".........###################..........",
                               "........#####################.........",
                               ".......#######################........",
                               "......########################........",
                               "......##########......#########.......",
                               "......#########........#########......",
                               ".....#########..........########......",
                               ".....########............#######......",
                               ".....########............#######......",
                               ".....########............########.....",
                               ".....########............########.....",
                               ".....########............########.....",
                               ".....#########..........#########.....",
                               "......########.........##########.....",
                               "......##########......###########.....",
                               ".......##########################.....",
                               ".......##########################.....",
                               "........#########################.....",
                               ".........########################.....",
                               "...........############..########.....",
                               ".............########....#######......",
                               ".........................#######......",
                               "........................########......",
                               "........................########......",
                               ".......................########.......",
                               "......................#########.......",
                               "....................##########........",
                               "..................############........",
                               "..............###############.........",
                               ".........###################..........",
                               "........###################...........",
                               "........##################............",
                               "........################..............",
                               "........##############................",
                               "........############..................",
                               ".........######.......................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................"
                       },
                       {
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               ".......................####...........",
                               "......................######..........",
                               "....................########..........",
                               "...................##########.........",
                               "..................###########.........",
                               ".................############.........",
                               "................############..........",
                               "...............###########............",
                               "..............###########.............",
                               ".............###########..............",
                               ".............##########...............",
                               "............##########................",
                               "............#########.................",
                               "...........#########..................",
                               "...........########...................",
                               "..........#########...................",
                               "..........########....................",
                               ".........#########....................",
                               ".........########.....................",
                               ".........########.....................",
                               ".........########.....................",
                               "........#########.....................",
                               "........########......................",
                               "........########......................",
                               "........########......................",
                               "........########......................",
                               "........########......................",
                               "........########......................",
                               "........########......................",
                               "........########......................",
                               "........########......................",
                               "........########......................",
                               ".........########.....................",
                               ".........########.....................",
                               ".........########.....................",
                               ".........#########....................",
                               "..........########....................",
                               "..........#########...................",
                               "..........#########...................",
                               "...........#########..................",
                               "...........##########.................",
                               "............#########.................",
                               ".............#########................",
                               ".............##########...............",
                               "..............###########.............",
                               "...............###########............",
                               "................###########...........",
                               ".................############.........",
                               "..................###########.........",
                               "...................##########.........",
                               "....................#########.........",
                               ".....................#######..........",
                               ".......................####...........",
                               ".........................#............",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................"
                       },
                       {
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "...........####.......................",
                               "..........######......................",
                               ".........#########....................",
                               ".........##########...................",
                               ".........###########..................",
                               ".........############.................",
                               "..........############................",
                               "............###########...............",
                               ".............###########..............",
                               "..............##########..............",
                               "...............##########.............",
                               "................##########............",
                               ".................#########............",
                               "..................#########...........",
                               "...................########...........",
                               "...................#########..........",
                               "....................########..........",
                               "....................#########.........",
                               ".....................########.........",
                               ".....................########.........",
                               ".....................########.........",
                               ".....................#########........",
                               "......................########........",
                               "......................########........",
                               "......................########........",
                               "......................########........",
                               "......................########........",
                               "......................########........",
                               "......................########........",
                               "......................########........",
                               "......................########........",
                               "......................########........",
                               ".....................########.........",
                               ".....................########.........",
                               ".....................########.........",
                               "....................#########.........",
                               "....................########..........",
                               "...................#########..........",
                               "...................#########..........",
                               "..................#########...........",
                               ".................##########...........",
                               "................##########............",
                               "................#########.............",
                               "..............###########.............",
                               ".............###########..............",
                               "............###########...............",
                               "...........###########................",
                               ".........############.................",
                               ".........###########..................",
                               ".........##########...................",
                               ".........#########....................",
                               "..........#######.....................",
                               "...........####.......................",
                               "............#.........................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................"
                       },
                       {
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               ".................#####................",
                               "................#######...............",
                               "................#######...............",
                               "................#######...............",
                               "................#######...............",
                               "................#######...............",
                               "................#######...............",
                               "................#######...............",
                               "................#######...............",
                               "................#######...............",
                               "......###########################.....",
                               "......###########################.....",
                               "......###########################.....",
                               "......###########################.....",
                               "......###########################.....",
                               "......###########################.....",
                               "......###########################.....",
                               "................#######...............",
                               "................#######...............",
                               "................#######...............",
                               "................#######...............",
                               "................#######...............",
                               "................#######...............",
                               "................#######...............",
                               "................#######...............",
                               "................#######...............",
                               "................#######...............",
                               ".................#####................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................"
                       },
                       {
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......##########################......",
                               ".....############################.....",
                               ".....############################.....",
                               ".....############################.....",
                               ".....############################.....",
                               ".....############################.....",
                               "......###########################.....",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................"
                       },
                       {
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               ".................####.................",
                               "................######................",
                               "................#######...............",
                               "...............########...............",
                               "...............########...............",
                               "................#######...............",
                               "................######................",
                               ".......#####....######.....####.......",
                               ".......######...######...#######......",
                               "......#########..#####.#########......",
                               "......###############.##########......",
                               "......##########################......",
                               "......##########################......",
                               ".......########################.......",
                               "............##############............",
                               "...............########...............",
                               "..............###########.............",
                               ".............#############............",
                               "...........########.#######...........",
                               "..........########..########..........",
                               "..........########..#########.........",
                               ".........########....########.........",
                               ".........########....########.........",
                               "..........#######.....#######.........",
                               "...........#####......######..........",
                               "............###.........##............",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................"
                       },
                       {
                               "......................................",
                               "......................................",
                               "......................................",
                               "...........................####.......",
                               "...........................######.....",
                               "..........................#######.....",
                               "..........................#######.....",
                               ".........................########.....",
                               ".........................#######......",
                               "........................########......",
                               "........................#######.......",
                               ".......................########.......",
                               ".......................#######........",
                               "......................########........",
                               "......................#######.........",
                               ".....................########.........",
                               ".....................########.........",
                               ".....................#######..........",
                               "....................########..........",
                               "....................#######...........",
                               "...................########...........",
                               "...................#######............",
                               "..................########............",
                               "..................#######.............",
                               ".................########.............",
                               ".................#######..............",
                               "................########..............",
                               "................#######...............",
                               "...............########...............",
                               "...............#######................",
                               "...............#######................",
                               "..............########................",
                               "..............#######.................",
                               ".............########.................",
                               ".............#######..................",
                               "............########..................",
                               "............#######...................",
                               "...........########...................",
                               "...........#######....................",
                               "..........########....................",
                               "..........#######.....................",
                               ".........########.....................",
                               ".........#######......................",
                               "........########......................",
                               "........########......................",
                               "........#######.......................",
                               ".......########.......................",
                               ".......#######........................",
                               "......########........................",
                               "......#######.........................",
                               ".....########.........................",
                               ".....#######..........................",
                               "......######..........................",
                               ".......#####..........................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................",
                               "......................................"
                       }};
#define H 65
#define W 38
char ch[]="0123456789()+-*/";
int num=0,mx[]={0,1,0,-1,1,-1,1,-1},my[]={1,0,-1,0,-1,1,1,-1},vis[100][10000];
int now=1,maxx[1001],minx[1001],maxy[1001],miny[1001],fnum[1001];
void dfs(int x,int y,int sz=0){
    maxx[now]=max(maxx[now],x);
    minx[now]=min(minx[now],x);
    maxy[now]=max(maxy[now],y);
    miny[now]=min(miny[now],y);
    num++;
    vis[x][y]=1;
    if(sz){
        a[x][y]='.';
    }
    for(int i=0;i<=7;i++){
        int nx=x+mx[i],ny=y+my[i];
        if(nx<1||ny<0||nx>h||ny>=w||a[nx][ny]!='#'||(vis[nx][ny]&&sz==0))continue;
        dfs(nx,ny,sz);
    }
}//dfs
void get_num_and_clean(){
    num=now=1;
    memset(vis,0,sizeof(vis));
    for(int j=1;j<=h;j++)
        for(int k=0;k<w;k++){
            if(a[j][k]=='#'&&vis[j][k]==0){
                num=0;
                maxy[now]=maxx[now]=0;
                miny[now]=minx[now]=1e8;
                dfs(j,k);
                if(num>=100){
                    fnum[now]=num;
                    now++;
                }
                else{
                    num=0;
                    maxy[now]=maxx[now]=0;
                    miny[now]=minx[now]=1e8;
                    dfs(j,k,1);
                }
            }
        }
    now--;
}//统计嵌入式文本文件中‘1’像素的个数并进行降噪
int total[]={694,508,674,629,641,644,691,529,745,670,527,529,359,199,385,423};//像素数量
/*int cmp(int num1,int num2){

}*/
vector<int> v[1000];
void prework(){
    for(int i=1;i<=now;i++){
        for(int j=minx[i];j<=maxx[i];j++)
            for(int k=miny[i];k<=maxy[i];k++){
                a[j][k]='+';
            }
    }
}
struct node{
    int a,b,c,d,fnum;
    bool operator <(const node &t)const{
        return a<t.a;
    }
}tmp_array[10001];
bool change[100][10001];
#define PI 3.141592654
double rad(int x){
    return double(x)*PI/180;
}
#define sin(x) sin(rad(x))
#define cos(x) cos(rad(x))
void turn(){
    for(int i=1;i<=now;i++){
        int x_t=(maxx[i]+minx[i])/2,y_t=(maxy[i]+miny[i])/2;
        int minn=1e8,id=0;
        memset(change,0,sizeof(change));
        for(int l=-15;l<=15;l++){
            int mx=1e8,mmx=0;
            bool flag=1;
            for(int j=minx[i];j<=maxx[i];j++){
                if(!flag)break;
                for(int k=miny[i];k<=maxy[i];k++){
                    if(a[j][k]=='#'){
                        /*if(int((k-y_t)*sin(id)+(j-x_t)*cos(id)+x_t)<1||int((k-y_t)*sin(id)+(j-x_t)*cos(id)+x_t)>h||int((k-y_t)*cos(id)-(j-x_t)*sin(id)+y_t)<0||int((k-y_t)*cos(id)-(j-x_t)*sin(id)+y_t)>=w){
                          //cout<<"pass "<<l<<endl;
                          flag=0;
                          break;
                        }*/
                        mx=min(mx,(k-y_t)*cos(l)-(j-x_t)*sin(l)+y_t);
                        mmx=max(mmx,(k-y_t)*cos(l)-(j-x_t)*sin(l)+y_t);
                    }
                }
            }
            if(flag&&mmx-mx<minn){
                minn=mmx-mx;
                id=l;
            }
        }
        for(int j=minx[i];j<=maxx[i];j++)
            for(int k=miny[i];k<=maxy[i];k++){
                if(a[j][k]=='#'){
                    //a[j][k]='+';
                    cout<<i<<" "<<int((k-y_t)*sin(id)+(j-x_t)*cos(id)+x_t)<<" "<<int((k-y_t)*cos(id)-(j-x_t)*sin(id)+y_t)<<endl;
                    a[int((k-y_t)*sin(id)+(j-x_t)*cos(id)+x_t)][int((k-y_t)*cos(id)-(j-x_t)*sin(id)+y_t)]='#';
                    if(!change[j][k])
                        a[j][k]='.';
                    change[int((k-y_t)*sin(id)+(j-x_t)*cos(id)+x_t)][int((k-y_t)*cos(id)-(j-x_t)*sin(id)+y_t)]=1;
                }
            }
        //cout<<i<<" "<<id<<endl;
    }
}
void sort_sx(){
    for(int i=1;i<=now;i++){
        tmp_array[i].a=miny[i];
        tmp_array[i].b=maxy[i];
        tmp_array[i].c=minx[i];
        tmp_array[i].d=maxx[i];
        tmp_array[i].fnum=fnum[i];
    }
    sort(tmp_array+1,tmp_array+now+1);
    for(int i=1;i<=now;i++){
        miny[i]=tmp_array[i].a;
        maxy[i]=tmp_array[i].b;
        minx[i]=tmp_array[i].c;
        maxx[i]=tmp_array[i].d;
        fnum[i]=tmp_array[i].fnum;
    }
}//排序
//65 38
int maxx_t[20],minx_t[20],maxy_t[20],miny_t[20],now_t,vis_t[70][40],num_t;
double Features[16][KUAN+1][KUAN+1],Features2[1000][KUAN+1][KUAN+1];
double Features3[16][KUAN2+1][KUAN2+1],Features4[1000][KUAN2+1][KUAN2+1];
int Hs2[1000],Ws2[1000];
void prework4(){
    for(int l=1;l<=now;l++){
        double vv=double(maxy[l]-miny[l])/KUAN;
        //cerr<<vv<<endl;
        for(int j=1;j<=KUAN;j++){
            Hs2[j]=miny[l]+vv*(j-1);
        }
        Hs2[KUAN+1]=maxy[l]+1;
        vv=double(maxx[l]-minx[l])/KUAN;
        //cerr<<vv<<endl;
        for(int j=1;j<=KUAN;j++){
            Ws2[j]=minx[l]+vv*(j-1);
        }
        Ws2[KUAN+1]=maxx[l]+1;
        for(int i=1;i<=KUAN;i++)
            for(int j=1;j<=KUAN;j++){
                double aa=0,bb=0;
                //cout<<i<<" "<<Ws[i]<<" "<<Ws[i+1]-1<<endl;
                //cout<<j<<" "<<Hs[j]<<" "<<Hs[j+1]-1<<endl;
                for(int ii=Ws2[i];ii<Ws2[i+1];ii++){
                    for(int jj=Hs2[j];jj<Hs2[j+1];jj++){
                        bb+=1;
                        aa+=(a[ii][jj]=='#');
                    }
                }
                Features2[l][i][j]=aa/bb;
                if(isnan(Features2[l][i][j])){
                    Features2[l][i][j]=0;
                }
            }

    }
}
void prework5(){
    for(int l=1;l<=now;l++){
        double vv=double(maxy[l]-miny[l])/KUAN2;
        //cerr<<vv<<endl;
        for(int j=1;j<=KUAN2;j++){
            Hs2[j]=miny[l]+vv*(j-1);
        }
        Hs2[KUAN2+1]=maxy[l]+1;
        vv=double(maxx[l]-minx[l])/KUAN2;
        //cerr<<vv<<endl;
        for(int j=1;j<=KUAN2;j++){
            Ws2[j]=minx[l]+vv*(j-1);
        }
        Ws2[KUAN2+1]=maxx[l]+1;
        for(int i=1;i<=KUAN2;i++)
            for(int j=1;j<=KUAN2;j++){
                double aa=0,bb=0;
                //cout<<i<<" "<<Ws[i]<<" "<<Ws[i+1]-1<<endl;
                //cout<<j<<" "<<Hs[j]<<" "<<Hs[j+1]-1<<endl;
                for(int ii=Ws2[i];ii<Ws2[i+1];ii++){
                    for(int jj=Hs2[j];jj<Hs2[j+1];jj++){
                        bb+=1;
                        aa+=(a[ii][jj]=='#');
                    }
                }
                Features4[l][i][j]=aa/bb;
                if(isnan(Features4[l][i][j])){
                    Features4[l][i][j]=0;
                }
            }

    }
}
void dfs2(int x,int y){
    //cerr<<x<<" "<<y<<endl;
    vis_t[x][y]=1;
    maxx_t[now_t]=max(maxx_t[now_t],x);
    maxy_t[now_t]=max(maxy_t[now_t],y);
    minx_t[now_t]=min(minx_t[now_t],x);
    miny_t[now_t]=min(miny_t[now_t],y);
    for(int i=0;i<=7;i++){
        int nx=x+mx[i],ny=y+my[i];
        if(nx<0||ny<0||nx>=65||ny>=38||number[now_t][nx][ny]=='.'||vis_t[nx][ny])continue;
        dfs2(nx,ny);
    }
}
void prework2(){
    memset(minx_t,0x3f,sizeof(minx_t));
    memset(miny_t,0x3f,sizeof(miny_t));
    for(int i=0;i<=15;i++){
        now_t=i;
        num_t=0;
        memset(vis_t,0,sizeof(vis_t));
        for(int j=0;j<=64;j++){
            for(int k=0;k<=37;k++){
                if(number[i][j][k]=='#'){
                    dfs2(j,k);
                    break;
                }
            }
        }
    }
}//捕捉嵌入式文本文件中的矩形
int Hs[1000],Ws[1000];
void prework3(){
    for(int l=0;l<=15;l++){
        double vv=double(maxy_t[l]-miny_t[l])/KUAN;
        //cerr<<vv<<endl;
        for(int j=1;j<=KUAN;j++){
            Hs[j]=miny_t[l]+vv*(j-1);
        }
        Hs[KUAN+1]=maxy_t[l]+1;
        vv=double(maxx_t[l]-minx_t[l])/KUAN;
        //cerr<<vv<<endl;
        for(int j=1;j<=KUAN;j++){
            Ws[j]=minx_t[l]+vv*(j-1);
        }
        Ws[KUAN+1]=maxx_t[l]+1;
        for(int i=1;i<=KUAN;i++)
            for(int j=1;j<=KUAN;j++){
                double aa=0,bb=0;
                //cout<<i<<" "<<Ws[i]<<" "<<Ws[i+1]-1<<endl;
                //cout<<j<<" "<<Hs[j]<<" "<<Hs[j+1]-1<<endl;
                for(int ii=Ws[i];ii<Ws[i+1];ii++){
                    for(int jj=Hs[j];jj<Hs[j+1];jj++){
                        bb+=1;
                        aa+=(number[l][ii][jj]=='#');
                    }
                }
                Features[l][i][j]=aa/bb;
                if(isnan(Features[l][i][j])){
                    Features[l][i][j]=0;
                }
            }
    }

}
void prework6(){
    for(int l=0;l<=15;l++){
        double vv=double(maxy_t[l]-miny_t[l])/KUAN2;
        //cerr<<vv<<endl;
        for(int j=1;j<=KUAN2;j++){
            Hs[j]=miny_t[l]+vv*(j-1);
        }
        Hs[KUAN2+1]=maxy_t[l]+1;
        vv=double(maxx_t[l]-minx_t[l])/KUAN2;
        //cerr<<vv<<endl;
        for(int j=1;j<=KUAN2;j++){
            Ws[j]=minx_t[l]+vv*(j-1);
        }
        Ws[KUAN2+1]=maxx_t[l]+1;
        for(int i=1;i<=KUAN2;i++)
            for(int j=1;j<=KUAN2;j++){
                double aa=0,bb=0;
                //cout<<i<<" "<<Ws[i]<<" "<<Ws[i+1]-1<<endl;
                //cout<<j<<" "<<Hs[j]<<" "<<Hs[j+1]-1<<endl;
                for(int ii=Ws[i];ii<Ws[i+1];ii++){
                    for(int jj=Hs[j];jj<Hs[j+1];jj++){
                        bb+=1;
                        aa+=(number[l][ii][jj]=='#');
                    }
                }
                Features3[l][i][j]=aa/bb;
                if(isnan(Features3[l][i][j])){
                    Features3[l][i][j]=0;
                }
            }
    }
}
double M;
int num_num[]={694,508,674,629,641,644,691,529,745,670,527,529,359,199,385,423};
vector<char> fin_ans;
stack<char> opter;    //运算符栈
stack<int> opval;  //操作数栈

int getIndex(char theta)   //获取theta所对应的索引
{
    int index = 0;
    switch (theta)
    {
        case '+':
            index = 0;
            break;
        case '-':
            index = 1;
            break;
        case '*':
            index = 2;
            break;
        case '/':
            index = 3;
            break;
        case '(':
            index = 4;
            break;
        case ')':
            index = 5;
            break;
        case '#':
            index = 6;
        default:break;
    }
    return index;
}

char getPriority(char theta1, char theta2)   //获取theta1与theta2之间的优先级
{
    const char priority[][7] =     //算符间的优先级关系
            {
                    { '>','>','<','<','<','>','>' },
                    { '>','>','<','<','<','>','>' },
                    { '>','>','>','>','<','>','>' },
                    { '>','>','>','>','<','>','>' },
                    { '<','<','<','<','<','=','0' },
                    { '>','>','>','>','0','>','>' },
                    { '<','<','<','<','<','0','=' },
            };

    int index1 = getIndex(theta1);
    int index2 = getIndex(theta2);
    return priority[index1][index2];
}

int calculate(int b, char theta, int a)   //计算b theta a
{
    switch (theta)
    {
        case '+':
            return b + a;
        case '-':
            return b - a;
        case '*':
            return b * a;
        case '/':
            return b / a;
        default:
            break;
    }
}
int now_ch;
char mygetchar(){
    if(now_ch<fin_ans.size()){
        return fin_ans[now_ch++];
    }
    else{
        return '#';
    }
}
double getAnswer()   //表达式求值
{
    opter.push('#');      //首先将'#'入栈opter
    int counter = 0;      //添加变量counter表示有多少个数字相继入栈，实现多位数的四则运算
    char c = mygetchar();
    while (c != '#' || opter.top() != '#')   //终止条件d
    {
        if (isdigit(c))   //如果c在'0'~'9'之间
        {
            if (counter == 1)   //counter==1表示上一字符也是数字，所以要合并，比如12*12，要算12，而不是单独的1和2
            {
                int t = opval.top();
                opval.pop();
                opval.push(t * 10 + (c - '0'));
                counter = 1;
            }
            else
            {
                opval.push(c - '0');     //将c对应的数值入栈opval
                counter++;
            }
            c = mygetchar();
        }
        else
        {
            counter = 0;   //counter置零
            switch (getPriority(opter.top(), c))   //获取运算符栈opter栈顶元素与c之间的优先级，用'>'，'<'，'='表示
            {
                case '<':               //<则将c入栈opter
                    opter.push(c);
                    c = mygetchar();
                    break;
                case '=':               //=将opter栈顶元素弹出，用于括号的处理
                    opter.pop();
                    c = mygetchar();
                    break;
                case '>':               //>则计算
                    char theta = opter.top();
                    opter.pop();
                    int a = opval.top();
                    opval.pop();
                    int b = opval.top();
                    opval.pop();
                    opval.push(calculate(b, theta, a));
            }
        }
    }
    return opval.top();   //返回opval栈顶元素的值
}
int main(){
    //freopen("data.txt","r",stdin);
    //freopen("out.txt","w",stdout);
    //ios::sync_with_stdio(0);
    cin>>t;
    cin>>w>>h;
    for(int i=1;i<=h;i++){
        cin>>a[i];
    }
    get_num_and_clean();
    sort_sx();
    prework2();
    prework3();
    prework4();
    prework5();
    prework6();
    for(int i=1;i<=now;i++){
        double minn=0;
        int id;
        for(int j=0;j<=15;j++){
            double sumarrayA=0,sumarrayB=0;
            double cosine=0;
            for(int ii=1;ii<=KUAN;ii++)
                for(int jj=1;jj<=KUAN;jj++){
                    sumarrayA+=Features[j][ii][jj]*Features[j][ii][jj];
                    sumarrayB+=Features2[i][ii][jj]*Features2[i][ii][jj];
                    cosine+=Features2[i][ii][jj]*Features[j][ii][jj];
                }
            sumarrayA=sqrt(sumarrayA);
            sumarrayB=sqrt(sumarrayB);
            cosine/=(sumarrayA*sumarrayB);
            if(cosine>minn){
                minn=cosine;
                id=j;
            }
        }

        int bfid=id;
        minn=0;
        for(int j=0;j<=15;j++){
            double sumarrayA=0,sumarrayB=0;
            double cosine=0;
            for(int ii=1;ii<=KUAN2;ii++)
                for(int jj=1;jj<=KUAN2;jj++){
                    sumarrayA+=Features3[j][ii][jj]*Features3[j][ii][jj];
                    sumarrayB+=Features4[i][ii][jj]*Features4[i][ii][jj];
                    cosine+=Features4[i][ii][jj]*Features3[j][ii][jj];
                }
            sumarrayA=sqrt(sumarrayA);
            sumarrayB=sqrt(sumarrayB);
            cosine/=(sumarrayA*sumarrayB);
            if(cosine>minn){
                minn=cosine;
                id=j;
            }
        }

        if(ch[id]=='+'||ch[id]=='-'||ch[id]=='*'||ch[id]=='/'){
            fin_ans.push_back(ch[id]);

        }
        else
            fin_ans.push_back(ch[bfid]);
    }
    /*for(int i=0;i<fin_ans.size();i++){
      putchar(fin_ans[i]);
    }
    cout<<endl;*/
    printf("%d\n",int(getAnswer()));
    return 0;
}
